import{_ as y}from"./extends-98964cd2.js";import{r as o}from"./index-c4905b50.js";import{a as h}from"./index-027e524b.js";import{a as L,$ as m,c as z}from"./index-746ec687.js";import{b as O}from"./index-ad15057c.js";import{$ as A}from"./index-07d1f67e.js";function K(r,e=globalThis==null?void 0:globalThis.document){const t=O(r);o.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)},[t,e])}const p="dismissableLayer.update",N="dismissableLayer.pointerDownOutside",H="dismissableLayer.focusOutside";let x;const R=o.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),X=o.forwardRef((r,e)=>{var t;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:b,onInteractOutside:l,onDismiss:u,...v}=r,c=o.useContext(R),[d,I]=o.useState(null),f=(t=d==null?void 0:d.ownerDocument)!==null&&t!==void 0?t:globalThis==null?void 0:globalThis.document,[,W]=o.useState({}),B=L(e,i=>I(i)),D=Array.from(c.layers),[S]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),_=D.indexOf(S),P=d?D.indexOf(d):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,g=P>=_,U=q(i=>{const $=i.target,T=[...c.branches].some(E=>E.contains($));!g||T||(a==null||a(i),l==null||l(i),i.defaultPrevented||u==null||u())},f),w=G(i=>{const $=i.target;[...c.branches].some(E=>E.contains($))||(b==null||b(i),l==null||l(i),i.defaultPrevented||u==null||u())},f);return K(i=>{P===c.layers.size-1&&(s==null||s(i),!i.defaultPrevented&&u&&(i.preventDefault(),u()))},f),o.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(x=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),C(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=x)}},[d,f,n,c]),o.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),C())},[d,c]),o.useEffect(()=>{const i=()=>W({});return document.addEventListener(p,i),()=>document.removeEventListener(p,i)},[]),o.createElement(m.div,y({},v,{ref:B,style:{pointerEvents:k?g?"auto":"none":void 0,...r.style},onFocusCapture:h(r.onFocusCapture,w.onFocusCapture),onBlurCapture:h(r.onBlurCapture,w.onBlurCapture),onPointerDownCapture:h(r.onPointerDownCapture,U.onPointerDownCapture)}))}),j=o.forwardRef((r,e)=>{const t=o.useContext(R),n=o.useRef(null),s=L(e,n);return o.useEffect(()=>{const a=n.current;if(a)return t.branches.add(a),()=>{t.branches.delete(a)}},[t.branches]),o.createElement(m.div,y({},r,{ref:s}))});function q(r,e=globalThis==null?void 0:globalThis.document){const t=O(r),n=o.useRef(!1),s=o.useRef(()=>{});return o.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let v=function(){F(N,t,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=v,e.addEventListener("click",s.current,{once:!0})):v()}n.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",a),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function G(r,e=globalThis==null?void 0:globalThis.document){const t=O(r),n=o.useRef(!1);return o.useEffect(()=>{const s=a=>{a.target&&!n.current&&F(H,t,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function C(){const r=new CustomEvent(p);document.dispatchEvent(r)}function F(r,e,t,{discrete:n}){const s=t.originalEvent.target,a=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?z(s,a):s.dispatchEvent(a)}const ee=X,te=j,ne=o.forwardRef((r,e)=>{var t;const{container:n=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...s}=r;return n?A.createPortal(o.createElement(m.div,y({},s,{ref:e})),n):null});export{ne as $,X as a,te as b,ee as c};
//# sourceMappingURL=index-621147ae.js.map
